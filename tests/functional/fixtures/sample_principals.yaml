# Sample principals for functional testing
# Represents realistic IAM roles/users with various risk profiles

principals:
  # Low-risk: narrow permissions, active, has owner
  - arn: "arn:aws:iam::123456789012:role/customer-support-agent-dev"
    type: "role"
    name: "customer-support-agent-dev"
    created_date: "2024-10-01T10:00:00Z"
    last_used: "2025-11-04T14:30:00Z"
    tags:
      Owner: "platform-team"
      Environment: "dev"
      Purpose: "Customer support agent runtime"
      AgentId: "customer-support"
    policy_summary:
      actions: ["bedrock:InvokeModel", "dynamodb:GetItem", "dynamodb:PutItem"]
      resources: ["arn:aws:bedrock:*:*:model/anthropic.claude-*", "arn:aws:dynamodb:*:*:table/agentcore-memory-dev"]
      has_wildcard_actions: false
      has_wildcard_resources: false

  # Moderate-risk: some wildcards, moderately active
  - arn: "arn:aws:iam::123456789012:role/warranty-docs-agent-staging"
    type: "role"
    name: "warranty-docs-agent-staging"
    created_date: "2024-09-15T08:00:00Z"
    last_used: "2025-11-02T09:15:00Z"
    tags:
      Owner: "product-team"
      Environment: "staging"
      Purpose: "Warranty documentation agent"
    policy_summary:
      actions: ["bedrock:InvokeModel", "s3:GetObject", "s3:PutObject", "lambda:InvokeFunction"]
      resources: ["arn:aws:bedrock:*:*:model/*", "arn:aws:s3:::warranty-docs-*/*", "arn:aws:lambda:*:*:function:warranty-*"]
      has_wildcard_actions: false
      has_wildcard_resources: true

  # High-risk: wildcard actions, inactive, missing tags (orphan)
  - arn: "arn:aws:iam::123456789012:role/legacy-admin-role"
    type: "role"
    name: "legacy-admin-role"
    created_date: "2023-06-01T12:00:00Z"
    last_used: "2024-08-15T16:45:00Z"
    tags: {}
    policy_summary:
      actions: ["s3:*", "dynamodb:*", "lambda:*"]
      resources: ["*"]
      has_wildcard_actions: true
      has_wildcard_resources: true

  # Orphan: missing Owner tag
  - arn: "arn:aws:iam::123456789012:role/orphan-test-role"
    type: "role"
    name: "orphan-test-role"
    created_date: "2024-07-10T11:00:00Z"
    last_used: "2025-10-20T10:00:00Z"
    tags:
      Environment: "dev"
    policy_summary:
      actions: ["bedrock:InvokeModel"]
      resources: ["arn:aws:bedrock:*:*:model/anthropic.claude-v2"]
      has_wildcard_actions: false
      has_wildcard_resources: false

  # Never used: no last_used date
  - arn: "arn:aws:iam::123456789012:role/unused-role"
    type: "role"
    name: "unused-role"
    created_date: "2024-08-01T09:00:00Z"
    last_used: null
    tags:
      Owner: "security-team"
      Environment: "dev"
      Purpose: "Testing"
    policy_summary:
      actions: ["logs:CreateLogGroup"]
      resources: ["arn:aws:logs:*:*:*"]
      has_wildcard_actions: false
      has_wildcard_resources: true

  # Production principal: low-risk, well-tagged, active
  - arn: "arn:aws:iam::123456789012:role/customer-support-agent-prod"
    type: "role"
    name: "customer-support-agent-prod"
    created_date: "2024-11-01T10:00:00Z"
    last_used: "2025-11-05T08:00:00Z"
    tags:
      Owner: "platform-team"
      Environment: "prod"
      Purpose: "Production customer support agent"
      AgentId: "customer-support"
    policy_summary:
      actions: ["bedrock:InvokeModel", "dynamodb:Query", "dynamodb:PutItem"]
      resources: ["arn:aws:bedrock:*:*:model/anthropic.claude-3-sonnet-*", "arn:aws:dynamodb:*:*:table/agentcore-memory-prod"]
      has_wildcard_actions: false
      has_wildcard_resources: false
